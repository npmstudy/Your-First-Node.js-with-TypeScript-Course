# TS+Node.jsè°ƒè¯•

å°½ç®¡ TypeScript è°ƒè¯•å¯èƒ½ä¼šé¢ä¸´ä¸€äº›éº»çƒ¦ï¼Œä½†ä½¿ç”¨åˆé€‚çš„å·¥å…·å’ŒæŠ€æœ¯ï¼Œç»“åˆè‰¯å¥½çš„è°ƒè¯•å®è·µï¼Œå¯ä»¥å¸®åŠ©ä½ è§£å†³å¤§éƒ¨åˆ†è°ƒè¯•é—®é¢˜ã€‚

æœ‰äº†ä¸Šé¢Node.jsè°ƒè¯•çš„çŸ¥è¯†ç‚¹ï¼Œç›¸ä¿¡å­¦ä¹ è¿™èŠ‚è°ƒè¯•tsç¼–å†™çš„nodeé¡¹ç›®åº”è¯¥æ›´å®¹æ˜“ã€‚

## **JavaScript debug terminal**

`VSCode`Â ä¸­æ—©å·²å†…ç½®äº†ç›¸å½“æ— è„‘çš„Â `Debug`Â æ–¹å¼ï¼Œå°±æ˜¯Â `JavaScript Debug Terminal`ï¼Œåˆ©ç”¨å®ƒæˆ‘ä»¬åªéœ€è¦è´Ÿè´£æ‰“æ–­ç‚¹ï¼Œåˆ«çš„ä»€ä¹ˆÂ `inspect`ã€`launch.json`Â éƒ½ä¸éœ€è¦å…³æ³¨ï¼Œä¸»æ‰“çš„å°±æ˜¯ä¸€ä¸ªæ— è„‘ã€ç®€å•ã€‚

åœ¨vscodeçš„ç»ˆç«¯å¯åŠ¨ä¸€ä¸ª JavaScriptè°ƒè¯•ç»ˆç«¯(JavaScript debug terminal)ï¼Œåœ¨è¯¥ç»ˆç«¯ä¸­å¯åŠ¨çš„æ‰€æœ‰nodeè¿›ç¨‹ä¼šè‡ªåŠ¨å¼€å¯debugã€‚è¿™ä¸ªæ¯”auto attachæ›´æœ‰é€‰æ‹©æ€§ä¸€äº›ï¼Œä»…ä»…å½±å“å½“å‰çš„ç»ˆç«¯ï¼Œæ— è„‘å¼€å¯ï¼Œéå¸¸é€‚åˆå¿«é€Ÿè°ƒè¯•ã€‚åœ¨JavaScriptè°ƒè¯•ç»ˆç«¯é‡Œï¼Œå¯ä»¥æ— è„‘å¼€å¯å¯¹js/tsè„šæœ¬çš„è°ƒè¯•ï¼Œå¯ä»¥ç›´æ¥æ‰“æ–­ç‚¹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨debuggerï¼Œæ— éœ€é…ç½® launch.jsonã€‚

å¼€å¯ä¸€ä¸ª JavaScript è°ƒè¯•ç»ˆç«¯ï¼Œç›´æ¥åœ¨ç»ˆç«¯è¿è¡Œä»»æ„ jsç¨‹åºï¼ŒåŒ…æ‹¬

- å•ä¸ªjsæ–‡ä»¶ï¼Œä½¿ç”¨ node test.js
- npm run script å‘½ä»¤ï¼Œä¾‹å¦‚ï¼šnpm run dev
- typescriptæ–‡ä»¶ï¼Œä½¿ç”¨ npx tsx test.ts
- å…¶ä»–ï¼Œæ¯”å¦‚webpackæ–‡ä»¶ã€jestæ–‡ä»¶ä¹Ÿæ”¯æŒ

åœ¨package.jsonæ–‡ä»¶scriptå‘½ä»¤ä¸Šæ–¹å‡ºç°çš„DebugæŒ‰é’®ï¼Œå’Œhoverå‡ºç°Debug ScriptæŒ‰é’®ï¼Œå‡ä¸ºå¼€å¯ JavaScript è°ƒè¯•ç»ˆç«¯ è¿›è¡Œè°ƒè¯•

![Untitled](img/Untitled%204.png)

## é€šè¿‡â€”inspectå®ç°

é€šè¿‡å…ˆå¯åŠ¨è°ƒè¯•è¿›ç¨‹æ–¹å¼

```jsx
$ npx tsx --inspect-brk src/main.ts
Debugger listening on ws://127.0.0.1:9229/fb1656c7-cf94-4337-9082-47acd5b53f69
For help, see: https://nodejs.org/en/docs/inspector
```

å¦‚ä¸‹å›¾ã€‚

![Untitled](img/Untitled%205.png)

## **launch.jsoné…ç½®æ–¹å¼**

å¯¹äºå¤æ‚è°ƒè¯•å¯è¿›è¡Œè‡ªå®šä¹‰é…ç½®ï¼Œvscodeå¯åœ¨è°ƒè¯•é¢æ¿æ™ºèƒ½åˆ›å»ºlaunch.jsonæ–‡ä»¶ï¼Œå¹¶ä¸”å¯é€šè¿‡ æ·»åŠ é…ç½®æŒ‰é’® è‡ªåŠ¨æ·»åŠ ä¸€äº›é»˜è®¤é…ç½®ã€‚

ä¿®æ”¹launch.jsonæ–‡ä»¶å†…å®¹å¦‚ä¸‹ã€‚

```bash
  	{
      "name": "debug with tsx loader",
      "type": "node",
      "request": "launch",
      "runtimeArgs": [
        "--loader",
        "tsx"
      ],
      "skipFiles": [
        "<node_internals>/**"
      ],
      "program": "${workspaceFolder}/src/main.ts",
      "outFiles": [
        "${workspaceFolder}/**/*.js"
      ]
    }
```

ç‚¹å‡»è¿è¡Œå³ä¾§ç»¿è‰²æŒ‰é’®ï¼Œå°±å¯ä»¥é¡ºåˆ©è¿›å…¥è°ƒè¯•ç•Œé¢äº†ã€‚

![Untitled](img/Untitled%206.png)

<aside>
ğŸ’¡ æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡â€”loaderå®ç°çš„ï¼ŒæŸ¥çœ‹runtimeArgså‚æ•°å°±çŸ¥é“äº†ã€‚

</aside>

## ç»™æµ‹è¯•æ–‡ä»¶å¢åŠ æ–­ç‚¹

launch.json

```bash
{
      "type": "node",
      "request": "launch",
      "name": "Unit test",
      "skipFiles": [
        "<node_internals>/**"
      ],
      "program": "${file}",
      "runtimeArgs": [
        "--loader",
        "tsx"
      ],
      "args": [
        "--test"
      ]
    },
```

åœ¨test.tsæ–‡ä»¶ä¸­å¢åŠ æ–­ç‚¹ã€‚cmd+4ï¼Œæ‰§è¡ŒUnit testï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘æ–­ç‚¹ã€‚

![Untitled](img/Untitled%207.png)
