
# TSDocæ–‡æ¡£

`TypeDoc`Â æ˜¯ä¸€æ¬¾Â `TypeScript`Â æ–‡æ¡£ç”Ÿæˆå·¥å…·ï¼Œå®ƒèƒ½å¤Ÿè¯»å–ä½ çš„Â `TypeScript`Â æºæ–‡ä»¶ï¼Œå¯¹å…¶è¿›è¡Œè¯­æ³•åˆ†æï¼Œæ ¹æ®å…¶ä¸­çš„ç±»å‹æ ‡æ³¨ä¸æ³¨é‡Šå†…å®¹ï¼Œè‡ªåŠ¨ä¸ºä½ çš„ä»£ç ç”ŸæˆåŒ…å«æ–‡æ¡£å†…å®¹çš„é™æ€ç½‘ç«™ã€‚ç”šè‡³å¯ä»¥é€šè¿‡API Extractorç”ŸæˆSDKæ–‡æ¡£ã€‚

é€‰æ‹©Â `TypeDoc`Â ä¸»è¦æœ‰ä»¥ä¸‹ç†ç”±ï¼š

- å……åˆ†åˆ©ç”¨äº†Â `TypeScript`Â çš„ç¼–è¯‘èƒ½åŠ›ï¼Œæ–‡æ¡£å†…å®¹å¹¶ä¸æ˜¯å®Œå…¨ä¾èµ–æ³¨é‡Šï¼Œ`TypeScirpt`Â çš„åŸç”Ÿç±»å‹æ ‡æ³¨ä¹Ÿå°†æˆæ–‡æ–‡æ¡£çš„é‡è¦å†…å®¹ã€‚
- æ³¨é‡Šç¬¦åˆå®˜æ–¹çš„Â [tsdoc](https://link.zhihu.com/?target=https%3A//tsdoc.org/)Â æ ‡å‡†è§„èŒƒã€‚
- å¯æ‹“å±•æ€§å¼ºï¼Œæœ‰è®¸å¤šæ’ä»¶å¯ä»¥æ»¡è¶³å¯èƒ½äº§ç”Ÿçš„ä¸ªæ€§åŒ–éœ€æ±‚ã€‚[typedoc æ’ä»¶](https://link.zhihu.com/?target=https%3A//typedoc.org/guides/plugins/)

TSDoc çš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š

- é‡‡ç”¨Â **TSDoc è§„èŒƒ**ç¼–å†™ä»£ç æ³¨é‡Š
- **api-extractor**Â åˆ†æä»£ç æ³¨é‡Šç”Ÿæˆæ–‡æ¡£æ¨¡å‹
- **api-documenter**Â è§£ææ–‡æ¡£æ¨¡å‹ç”Ÿæˆæ¥å£æ–‡æ¡£

> TSDoc ä¸»è¦åŒ…å«ä¸Šé¢ä¸‰å¤§æ­¥ï¼šTSDoc è§„èŒƒã€api-extractorã€api-documenterï¼Œæ–‡æ¡£æ¨¡å‹ä¹Ÿå«åšÂ Doc Modelï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ª json æ–‡ä»¶ï¼šåŒ…å«äº†æºç ä¸­ TSDoc è§„èŒƒçš„ç›¸å…³å®šä¹‰
>

api-extractor æ˜¯ä¸€ä¸ªå•ç‹¬çš„ npm åŒ…ï¼Œéœ€è¦å•ç‹¬å®‰è£…ï¼š

```
$ npm i -D @microsoft/api-extractor
```

ä½¿ç”¨ä¹‹å‰éœ€è¦åˆå§‹åŒ–ç”Ÿæˆé…ç½®æ–‡ä»¶Â `api-extractor.json`

```
$ npx api-extractor init
```

ç„¶åä½¿ç”¨å³å¯ï¼Œå…·ä½“ç”¨æ³•å¯æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://api-extractor.com/pages/setup/invoking/)

```
$ api-extractor run
```

api-documenter æ˜¯ä¸€ä¸ªå•ç‹¬çš„ npm åŒ…ï¼Œéœ€è¦å•ç‹¬å®‰è£…ï¼š

```
$ npm i -D @microsoft/api-documenter
```

è½¬æ¢Â `*.api.json`Â æ–‡æ¡£æ¨¡å‹æ–‡ä»¶ä¸º markdown æ–‡ä»¶ï¼š

```
$  npx api-documenter markdown
```

[https://tsdoc.org/play/](https://tsdoc.org/play/)

```json
"scripts": {
    "doc": "npx api-extractor run --local && api-documenter markdown -i temp -o docs/api && node docs/build.js"
  },

```

æ­¥éª¤

1. æŠ½å– npx api-extractor run --local
2. å˜æˆmarkdownæ–‡æ¡£ npx api-documenter markdown -i temp -o docs/api
3. ç¼–è¯‘æˆhtmlå¹¶å¯åŠ¨httpæœåŠ¡ç«¯ã€‚ node docs/build.js

## æ–‡æ¡£ç¼–å†™

é€‰ç”¨çš„æ˜¯metalsmithï¼Œä¸€ä¸ªåŸºäº NodeJS å¼€å‘çš„è¶…çº§ç®€å•ã€æ’ä»¶åŒ–çš„é™æ€ç½‘ç«™ç”Ÿæˆå·¥å…·ã€‚ä¹‹æ²¡æœ‰é€‰harpã€hexoã€docsifyï¼Œvitepressï¼Œdocusaurusè¿™äº›å¤§å¤§æœ‰åçš„ï¼Œä½†æ˜¯å®ƒä»¬éƒ½å¤ªé‡äº†ï¼Œå®‰è£…åŒ…æ¯”è¾ƒå¤§ï¼Œå†…ç½®åŠŸèƒ½è¾ƒå¤šã€‚

metalsmithå´æ°æ°ç›¸åï¼Œæ¯”å¦‚jsdocå°±æ˜¯ç”¨å®ƒç¼–å†™çš„ï¼Œå‚è€ƒ[https://github.com/jsdoc/jsdoc.github.io/blob/master/gulpfile.js](https://github.com/jsdoc/jsdoc.github.io/blob/master/gulpfile.js)ã€‚

## ç¤ºä¾‹

ä¸‹é¢æ˜¯å®˜æ–¹çš„[ä¾‹å­](https://github.com/metalsmith/metalsmith/tree/master/examples/static-site)ï¼Œä»£ç å¦‚ä¸‹

```jsx
import { fileURLToPath } from 'node:url'
import { dirname } from 'node:path'
import Metalsmith from 'metalsmith'
import collections from '@metalsmith/collections'
import layouts from '@metalsmith/layouts'
import markdown from '@metalsmith/markdown'
import permalinks from '@metalsmith/permalinks'

const __dirname = dirname(fileURLToPath(import.meta.url))
const t1 = performance.now()

Metalsmith(__dirname)         // parent directory of this file
  .source('./src')            // source directory
  .destination('./build')     // destination directory
  .clean(true)                // clean destination before
  .env({                      // pass NODE_ENV & other environment variables
    DEBUG: process.env.DEBUG,
    NODE_ENV: process.env.NODE_ENV
  })
  .metadata({                 // add any variable you want & use them in layout-files
    sitename: "My Static Site & Blog",
    siteurl: "https://example.com/",
    description: "It's about saying Â»HelloÂ« to the world.",
    generatorname: "Metalsmith",
    generatorurl: "https://metalsmith.io/"
  })
  .use(collections({          // group all blog posts by internally
    posts: 'posts/*.md'       // adding key 'collections':'posts'
  }))                         // use `collections.posts` in layouts
  .use(markdown())            // transpile all md into html
  .use(permalinks({           // change URLs to permalink URLs
    relative: false           // put css only in /css
  }))
  .use(layouts())             // wrap layouts around html
  .build((err) => {           // build process
    if (err) throw err        // error handling is required
    console.log(`Build success in ${((performance.now() - t1) / 1000).toFixed(1)}s`)
  });
```

è¯´æ˜å¦‚ä¸‹ã€‚

1. sourceå’Œdestinationï¼Œå’Œgulpç”¨æ³•ç±»ä¼¼
2. useæ’ä»¶åšæ³•ï¼Œå’Œkoaä¸­é—´ç”¨æ³•ç±»ä¼¼

## ä½¿ç”¨å·²æœ‰æ’ä»¶

```jsx

import layouts from "@metalsmith/layouts";

...
.use(
    layouts({
      default: "layout.hbs",
      directory: "./docs/layouts",
      engineOptions: {
        helpers: {
          formattedDate: function (date) {
            return new Date(date).toLocaleDateString();
          },
        },
      },
    })
  )
```

å¸ƒå±€æ–‡ä»¶layout.hbsé‡Œéœ€è¦ç•™å¥½contentsæ’æ§½ã€‚

```jsx
<!DOCTYPE html>
<html>

<head></head>

<body>
  {{{ contents }}}
</body>

</html>
```

å…¶ä»–å°±æ˜¯å‰ç«¯ç†Ÿæ‚‰çš„å†…å®¹äº†ã€‚

<aside>
ğŸ’¡ æ­¤æ—¶ç”¨handlebarsæ¨¡ç‰ˆï¼Œéœ€è¦å®‰è£…"jstransformer-handlebars": "^1.2.0"ä¾èµ–

</aside>

## æ‰©å±•æ’ä»¶

æ‰©å±•æ’ä»¶æ˜¯ä¸€ä¸ªéå¸¸ä½¿ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æˆ‘æƒ³æŠŠæ–‡ä»¶ä¸­çš„.mdæ›¿æ¢.htmlï¼Œä»£ç å¦‚ä¸‹ã€‚

```jsx
.use(function snapshot(files, metalsmith) {
    // console.log(metalsmith);
    // console.log(files);
    for (const [key, value] of Object.entries(files)) {
      console.log(`   - ${key}`);
      files[key]["contents"] = Buffer.from(
        files[key]["contents"].toString().replaceAll(".md", ".html"),
        "utf-8"
      );
    }
  })
```

## å¯åŠ¨

åœ¨æ„å»ºå‡½æ•°é‡Œï¼Œå¯åŠ¨httpæœåŠ¡å³å¯ã€‚

```jsx
.build((err) => {
    // build process
    if (err) throw err; // error handling is required
    console.log(
      `Build success in ${((performance.now() - t1) / 1000).toFixed(1)}s`
    );

    // Serve up public/ftp folder
    var serve = serveStatic("dist/docs", {
      index: ["index.html", "index.htm"],
    });

    // Create server
    var server = http.createServer(function onRequest(req, res) {
      serve(req, res, finalhandler(req, res));
    });

    // Listen
    server.listen(3001);

    console.log("creat server success. http://127.0.0.1:3001");
  });
```

ä»¥ä¸Šä¸ºNodejsæœ€ç®€å•çš„http staticæœåŠ¡ä»£ç ã€‚

åœ¨åšè¿™ä¸ªåœ°æ–¹æŠ€æœ¯é€‰å‹çš„æ—¶å€™ï¼Œæœ‰è€ƒè™‘è¿‡serveå’Œhttp-serverã€node-staticï¼Œå®ƒä»¬éƒ½è¿˜æ˜¯åŒ…æ¯”è¾ƒå¤§ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿç•¥å¾®éº»çƒ¦ã€‚ç»“åˆæœ¬è¯¾ç¨‹ä»¥å…¥é—¨ä¸ºä¸»ï¼Œæ‰€ä»¥é‡‡ç”¨nodeå†…ç½®çš„httpæœåŠ¡ã€‚

æ‰§è¡Œ

```jsx
$ node docs/build.js
   - .DS_Store
   - about.md
   - api/index.md
   - api/your-first-nodejs-helloworld-with-ts.iperson.md
   - api/your-first-nodejs-helloworld-with-ts.iperson.sayhi.md
   - api/your-first-nodejs-helloworld-with-ts.md
   - build.js
   - css/style.css
   - index.md
   - layouts/default.hbs
   - layouts/layout.hbs
   - layouts/post.hbs
Build success in 0.1s
creat server success. http://127.0.0.1:3001
```

![Untitled](img/Untitled%208.png)
